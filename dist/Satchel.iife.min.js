/*! satchel v1.0.0 | (c) 2022 undefined | ISC License | https://github.com/bnjmnrsh/ */
var satchel=function(t){"use strict";class e{#t="stcl";#e;#s;constructor(t=null,e={},s=!1,a="satchel"){if(this.#s=s?localStorage:sessionStorage,!this.#a(this.#s))return!1;if(!t)throw new Error("Satchel: a Key is required.");this.#e=`${this.#t}.${this.pocket}.${this.key}`,this.settings={data:void 0,expiry:null},this.cargo={...this.settings,...e},Object.defineProperty(this.cargo,"creation",{enumerable:!0,writable:!1,value:Date.now()}),this.set(this.cargo)}#i(t){t={type:null,key:null,action:null,data:null,...t};const e=new CustomEvent("Satchel",{bubbles:!0,cancelable:!0,detail:t});return document.dispatchEvent(e)}#a(t){try{storageAvailable(t)}catch(e){if(!this.#r(t))return!1}}#r(t){return t&&("QUOTA_EXCEEDED_ERR"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name||"QuotaExceededError"===t.name)}age(){const t=JSON.parse(this.#s.getItem(this.#e));return{age:Date.now()-t.creation,creation:t.creation,expiry:t.expiry,fresh:this.isFresh()}}bin(){if(this.#s.removeItem(this.#e),!this.#s.getItem(this.#e))return this.#i({type:this.#s,key:this.#e,action:"bin"}),null}get(t=!1){const e=this.#s.getItem(this.#e);return this.isFresh()&&!t?e:t?JSON.parse(this.#s.getItem(this.#e)):(this.#i({type:this.#s,key:this.#e,action:"get",data:e}),this)}set({data:t,expiry:e,creation:s}){const a=this.get(!0),i={};return i.data=t||null,i.expiry=e||this.cargo?.expiry||null,i.creation=a?.creation||this.cargo.creation,this.#s.setItem(this.#e,JSON.stringify(i)),this.#i({type:this.#s,key:this.#e,action:"set",data:i}),this}isFresh(){const t=JSON.parse(this.#s.getItem(this.#e));return!t?.expiry||t.expiry-Date.now()>0}getID(){return this.#e}static getAllPocketKeys(t="satchel",e=!1){return Object.keys(localStorage).map((e=>e.startsWith(this.#t+"."+t)?e:"")).filter((function(t){return t}))}static emptyPocket(t="satchel",s=!1){const a=s?localStorage:sessionStorage,i=e.getAllPocketKeys(this.#t+"."+t,a);if(!i.length)return null;Object.keys(i).forEach((t=>{a.removeItem(i[t])}));const r=e.getAllPocketKeys(t,a).length;return document.dispatchEvent(new CustomEvent("Satchel",{bubbles:!0,cancelable:!0,detail:{action:"emptyPocket",remaing:r}})),r}static cleanPocket(t="satchel",s=!1){const a=s?localStorage:sessionStorage,i=e.getAllPocketKeys(t,a);if(!i.length)return null;Object.keys(i).forEach((t=>{const e=JSON.parse(a.getItem(i[t])).expiry;if(!e||e-Date.now()>0)return null;a.removeItem(i[t])}));const r=e.getAllPocketKeys(this.#t+"."+t,a).length;return document.dispatchEvent(new CustomEvent("SatchelStatic",{bubbles:!0,cancelable:!0,detail:{action:"cleanPocket",remaing:r}})),r}static getKey(t,s="satchel",a=!1){const i=`${this.#t}.${this.pocket}.${this.key}`;return!!(a?localStorage:sessionStorage).getItem(i)&&new e(t,null,a,s)}}return t.Satchel=e,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=Satchel.iife.min.js.map
