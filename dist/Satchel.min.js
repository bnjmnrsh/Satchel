/* ! @preserve @bnjmnrsh/satchel v0.2.0 | (c) 2022 bnjmnrsh | ISC | https://github.com/bnjmnrsh/satchel */
class t{static _stcl;#t;#e;#r;constructor(e=null,r={},o=!1,s="pocket"){if(this.#e=o?window.localStorage:window.sessionStorage,!e)throw new Error('Satchel: a "key" is required.');if("string"!=typeof e)throw new Error('Satchel: "key" must be a string.');if("object"!=typeof r)throw new Error("Satchel: {cargo} must be an object.");if("boolean"!=typeof o)throw new Error('Satchel: "local" must be a boolean.');if("string"!=typeof s)throw new Error('Satchel: "pocket" must be a string.');this.#t=`${t.stcl}.${s}.${e}`,this.#r={data:void 0,expiry:null},r={...this.#r,...r},this.set(r)}static set stcl(t){if("string"!=typeof t)throw new Error("Satchel.stcl must be a string.");this._stcl=t}static get stcl(){return this._stcl?this._stcl:"stcl"}age(){const t=JSON.parse(this.#e.getItem(this.#t));return t?{age:Number(Date.now()-t.creation),creation:Number(t.creation),expiry:t.expiry?Number(t.expiry):null,fresh:Boolean(this.isFresh())}:null}bin(){const e=this.#e.getItem(this.#t);return e?(this.#e.removeItem(this.#t),t.#o({key:String(this.#t),oldValue:String(e),storageArea:String(t.#s(this.#e)),action:"bin"}),!0):null}get(t=!1){const e=this.#e.getItem(this.#t);return!!e&&(!!(this.isFresh()&&!t||t)&&JSON.parse(e))}set({data:e,expiry:r}){if("number"!=typeof r&&null!==r)throw new Error('Satchel.set({expiry}): "expiry" must be null or a number.');if(e&&"string"!=typeof e&&"object"!=typeof e)throw new Error('Satchel.set({data}): "data" must be a string or an object.');if(e&&"object"==typeof e)try{JSON.parse(JSON.stringify(e))}catch(t){throw new Error(`Satchel.set({data}): 'data': ${t}`)}const o=this.get(!0),s={};return s.data=e||null,s.expiry=r||null,s.creation=Number(o.creation)||Date.now(),this.#e.setItem(this.#t,JSON.stringify(s)),t.#o({key:String(this.#t),newValue:JSON.stringify(s),oldValue:o?JSON.stringify(o):null,storageArea:String(t.#s(this.#e)),action:"set"}),this}isFresh(){const t=JSON.parse(this.#e.getItem(this.#t));return t?Boolean(!t?.expiry||t.expiry-Date.now()>0):null}getKey(){return String(this.#t)}static#o(t={}){t={...{key:null,newValue:null,oldValue:null,storageArea:null,url:String(window.location.href),action:null},...t};const e=new CustomEvent("Satchel",{bubbles:!0,cancelable:!0,detail:t});return document.dispatchEvent(e)}static#s(t){return t===window.localStorage?"LocalStorage":"SessionStorage"}static getSatchel(e,r=!1,o="pocket"){if(!e)throw new Error('Satchel.getSatchel(key): a "key" is required.');if("string"!=typeof e)throw new Error('Satchel.getSatchel(key): "key" must be a string.');if("boolean"!=typeof r)throw new Error('Satchel.getSatchel(key, local): "local" must be a boolean.');if("string"!=typeof o)throw new Error('Satchel.getSatchel(key, local, pocket): "pocket" must be an string.');const s=`${t.stcl}.${o}.${e}`,i=r?window.localStorage:window.sessionStorage,n=JSON.parse(i.getItem(s));return!(!n||0===n.length)&&new t(e,n,r,o)}}export{t as Satchel};
//# sourceMappingURL=Satchel.min.js.map
