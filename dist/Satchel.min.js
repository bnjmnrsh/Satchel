/* ! @preserve @bnjmnrsh/satchel v0.2.0 | (c) 2022 bnjmnrsh | ISC | https://github.com/bnjmnrsh/satchel */
class t{static _stcl;#t;#e;#r;constructor(e=null,r={},s=!1,o="pocket"){if(this.#e=s?window.localStorage:window.sessionStorage,!e)throw new Error('Satchel: a "key" is required.');if("string"!=typeof e)throw new Error('Satchel: "key" must be a string.');if(!this.#s(r))throw new Error("Satchel: {cargo} must be an object.");if("boolean"!=typeof s)throw new Error('Satchel: "local" must be a boolean.');if("string"!=typeof o)throw new Error('Satchel: "pocket" must be a string.');this.#t=`${t.stcl}.${o}.${e}`,this.#r={data:void 0,expiry:null},r={...this.#r,...r},this.set(r)}static set stcl(t){if("string"!=typeof t)throw new Error("Satchel.stcl must be a string.");this._stcl=t}static get stcl(){return this._stcl?this._stcl:"stcl"}age(){const t=JSON.parse(this.#e.getItem(this.#t));return t?{age:Date.now()-t._creation,creation:t._creation,expiry:t.expiry?t.expiry:null,fresh:this.isFresh()}:null}bin(){const e=this.#e.getItem(this.#t);return e?(this.#e.removeItem(this.#t),t.#o({key:this.#t,oldValue:e,storageArea:t.#i(this.#e),action:"bin"}),!0):null}get(t=!1){const e=this.#e.getItem(this.#t);return!!e&&(!!(this.isFresh()&&!t||t)&&JSON.parse(e))}set({data:e,expiry:r}){if("number"!=typeof r&&null!==r)throw new Error('Satchel.set({expiry}): "expiry" must be null or a number.');if(e&&"string"!=typeof e&&!this.#s(e))throw new Error('Satchel.set({data}): "data" must be a string or an object.');if(e&&this.#s(e))try{JSON.parse(JSON.stringify(e))}catch(t){throw new Error(`Satchel.set({data}): 'data': ${t}`)}const s=this.get(!0),o={};return o.data=e||null,o.expiry=r||null,o._creation=s._creation||Date.now(),this.#e.setItem(this.#t,JSON.stringify(o)),t.#o({key:this.#t,newValue:JSON.stringify(o),oldValue:s?JSON.stringify(s):null,storageArea:t.#i(this.#e),action:"set"}),this}isFresh(){const t=JSON.parse(this.#e.getItem(this.#t));return t?!t?.expiry||t.expiry-Date.now()>0:null}getKey(){return this.#t}static#o(t={}){t={...{key:null,newValue:null,oldValue:null,storageArea:null,url:window.location.href,action:null},...t};const e=new CustomEvent("Satchel",{bubbles:!0,cancelable:!0,detail:t});return document.dispatchEvent(e)}static#i(t){return t===window.localStorage?"LocalStorage":"SessionStorage"}#s(t){return t&&"object"==typeof t&&t.constructor===Object}static getSatchel(e,r=!1,s="pocket"){if(!e)throw new Error('Satchel.getSatchel(key): a "key" is required.');if("string"!=typeof e)throw new Error('Satchel.getSatchel(key): "key" must be a string.');if("boolean"!=typeof r)throw new Error('Satchel.getSatchel(key, local): "local" must be a boolean.');if("string"!=typeof s)throw new Error('Satchel.getSatchel(key, local, pocket): "pocket" must be an string.');const o=`${t.stcl}.${s}.${e}`,i=r?window.localStorage:window.sessionStorage,a=JSON.parse(i.getItem(o));return!(!a||0===a.length)&&new t(e,a,r,s)}}export{t as Satchel};
//# sourceMappingURL=Satchel.min.js.map
